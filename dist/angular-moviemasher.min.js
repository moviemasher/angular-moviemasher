!function(){"use strict";function d(e,r){var t,a;if(e){if(e.indexOf)return e.indexOf(r);for(a=e.length,t=0;t<a;t++)if(e[t]===r)return t}return-1}function u(e){for(;e&&!e.data("amm-directive");)e=e.parent();return e}function _(e){for(var r=0,t=[],a=e[r];a;)t.push(a),a=e[++r];return t.join("")}var h={rest:{media:{search:{url:"php/media.php?group=:group",params:{group:"@group"},method:"get",isArray:!0}},module:{search:{url:"php/media.php?group=:group",params:{group:"@group"},method:"get",isArray:!0}},mash:{search:{url:"php/media.php?group=mash",method:"get",isArray:!0},data:{url:"php/mash.php?id=:id",params:{id:"@id"},method:"get"},save:{url:"php/save.php?id=:id",params:{id:"@id"},method:"post"}},import:{api:{url:"php/import_api.php",method:"post"},init:{url:"php/import_init.php",method:"post"},monitor:{url:"php/import_monitor.php",method:"post"}},export:{init:{url:"php/export_init.php",method:"post"},monitor:{url:"php/export_monitor.php",method:"post"}}}},e=angular.module("angular.moviemasher",["ngResource","ngAnimate","colorpicker.module","angularFileUpload","ui.bootstrap"]);e.config(["$httpProvider",function(e){e.defaults.useXDomain=!0,e.defaults.withCredentials=!0}]),e.constant("amm_resources",{}),e.config(["$provide",function(e){var t=["$http"],a=MovieMasher,r=a.prototype;a.$inject=t,r.initialize=function(){this.registered=a.registered,this.supported=a.supported;var e,r=t.length;for(this.amm_injected={},e=0;e<r;e++)this.amm_injected[t[e]]=this.instance_arguments[e]},r.__player=null,Object.defineProperty(r,"player",{get:function(){return this.__player||(this.__player=a.player()),this.__player},set:function(e){this.__player=e}}),e.service("$amm",a)}]),e.directive("ammUi",["$amm","amm_resources","$resource",function(d,u,f){return{templateUrl:"views/ui.html",restrict:"AEC",controller:["$scope","$window","$interval","amm_resources",function(m,i,l,c){m.amm_resources=c;function s(e){for(var r=d.mashes.length,t=0;t<r;t++)if(d.mashes[t].id===e)return d.mashes[t];return!1}var n=-1,p={};d.player.did=function(e){e&&n>=d.player.action_index&&(n=-2)},m.amm_export_displayed_status=function(){m.amm_export_completed=0},m.amm_export_completed=0,m.amm_import_completed=0,m.amm_export_status="",m.amm_import_status="",d.render=function(){var n=d.mash_id;c.export&&(m.amm_export_completed=.01,c.export.init({id:n},function(e){var r,t,a,o,i;e.ok?(m.amm_export_completed=.02,r=e,t=n,a=!1,i=o=0,o=l(function(){a||(a=!0,c.export.monitor(r,function(e){var r;a=!1,e.ok?0<e.completed&&e.completed<1?m.amm_export_completed=Math.max(.03,e.completed):(l.cancel(o),1===e.completed&&((r=s(t))&&(r.source=e.source),m.amm_export_completed=0)):(m.amm_export_status=e.error||_(e),m.amm_export_completed=-1,l.cancel(o))},function(e){a=!1,e.status||i++,5<i&&(m.amm_export_status=String(i)+" error responses from export monitor cgi",m.amm_export_completed=-1,l.cancel(o))}))},5e3)):(m.amm_export_status=e.error||_(e),m.amm_export_completed=-1)},function(e){console.error("export.init",e),m.amm_export_status="error response from export init",m.amm_export_completed=-1}))},d.can=function(e){var r=!1;switch(e){case"render":r=c.export&&d.player.duration&&!d.can("save");break;case"save":r=c.mash&&c.mash.save&&n!==d.player.action_index}return r},d.save=function(t){var a,o;c.mash&&c.mash.save&&(a=d.mash_id,o=d.player.action_index,c.mash.save({id:a},d.player.mash,function(e){var r;e.ok?a===d.mash_id&&(n=o,p[a]&&delete p[a],(r=s(a))&&(r.label=d.player.mash.label),t&&(d.mash_id=t,d.mash_id_change())):i.alert(e.error||_(e))}))},m.amm_view_mash=function(){i.open(d.selected_mash.source)},d.mash_id_change=function(){var e,r=d.mash_id,t=d.player.mash.id;d.can("save")?(d.mash_id=t,i.confirm('Save changes to "'+d.player.mash.label+'"?')&&d.save(r)):(e={},r?(t=s(r))&&(d.selected_mash=t,e.label=t.label,e.id=r,p[r]||c.mash&&c.mash.data({id:r},function(e){e.ok?r===d.mash_id&&(n=-1,d.player.mash=e.data):i.alert(e.error||_(e))})):(e.label="New Untitled Mash",e.id=d.player.uuid(),p[e.id]=!0,d.mashes.push(e),d.mash_id=e.id,d.selected_mash=e),d.mash_id===e.id&&(n=-1,d.player.mash=e))},d.mashes=[],d.mash_id=0,m.$amm=d,m.log_mash=function(){},m.amm_style_media_icon=function(e){var r,t={};if(e.icon)r=e.icon;else switch(e.type){case"image":r=e.url||e.source;break;case"audio":r=e.wave}return"audio"===e.type&&(t["background-size"]="100% 100%"),r&&(t["background-image"]="url("+r+")"),t},m.amm_media_icon_url=function(e){var r;if(e)if(e.icon)r=e.icon;else switch(e.type){case"image":r=e.url||e.source;break;case"audio":r=e.wave}return r}}],link:function(e,r,t){var a,o,i,n,m,l,c,s,p;for(l in d.MovieMasher.configure({mash:{default:{quantize:10}}}),t.$attr)switch(l){case"class":case"ammUi":break;default:if(s=t.$attr[l],c=t[l],"amm"===(m=s.split("-")).shift())for(i=m.length,a=p=p||{},o=0;o<i;o++)a[n=m[o]]||(a[n]=o===i-1?c:{}),a=a[n]}!function(e,r,t){var a,o,i,n,m,l;for(n in e=e||h,h.rest)if((m=h.rest[n])!==(l=e.rest[n])&&!0!==l||(l=m),l){for(o in i={},l)a={},m[o].isArray&&(a.isArray=!0),a.method=m[o].method,a.url=l[o].url,l[o].params&&(a.params=l[o].params),i[o]=a;r[n]=t(null,null,i)}}(p,u,f),u.module&&u.module.search&&(u.module.search({group:"font"},function(e){d.MovieMasher.register("font",e),u.mash&&u.mash.search({},function(e){e.length&&(angular.forEach(e,function(e){d.mashes.push(e)}),d.mash_id=d.mashes[0].id),d.mash_id_change()})}),u.module.search({group:"filter"},function(e){d.MovieMasher.register("filter",e)}),u.module.search({group:"scaler"},function(e){d.MovieMasher.register("scaler",e)}),u.module.search({group:"merger"},function(e){d.MovieMasher.register("merger",e)}))}}}]),e.directive("ammPlayer",["$window","$amm",function(o,i){return{restrict:"AEC",replace:!1,template:'<canvas id="amm-canvas"></canvas>',link:function(e,r){var t,a;o.CanvasRenderingContext2D&&(t=r.find("canvas"),a=r[0].getBoundingClientRect(),t.attr("width",a.width),t.attr("height",a.height),i.player.canvas_context=t[0].getContext("2d"),r.on("$destroy",function(){i.player.destroy()}))}}}]),e.directive("ammBrowser",["$timeout","$interval","$amm","amm_resources",function(t,l,e,c){return{restrict:"AEC",replace:!1,controller:["$scope","FileUploader",function(i,e){function n(){for(var e,r=0,t=0,a=m.length,o=0;o<a;o++){if(-1===(e=m[o]).completed)return i.amm_import_completed=-1,i.amm_import_status=e.status,0;t++,r+=e.completed}i.amm_import_completed=t?r/t:0,i.amm_import_status=""}function a(e){for(var r,t=m.length,a=0;a<t;a++)if((r=m[a]).upload===e)return r;return!1}var e=i.uploader=new e({scope:i}),r={},m=[];c.import&&(e.onProgressItem=function(e,r){var t=a(e);t?(t.completed=Math.max(.03,r/200),n()):console.error("could not find upload for item",e)},e.onAfterAddingFile=function(t){var e={};e.file=t.file.name,e.size=t.file.size,e.type=t.file.type;var a={uploading:!0};a.upload=t,a.completed=.01,a.name=e.name,m.unshift(a),n();function o(e,r){e.completed=-1,e.status=r,n()}c.import.init(e,function(e){if(e.ok){if(a.completed=.02,t.formData.push(e.data),e.headers)for(var r in e.headers)t.headers[r]=e.headers[r];a.api=e.api,t.url=e.endpoint,t.method=e.method,t.upload()}else o(a,e.error||_(e))},function(){o(a,"error")})},e.onSuccessItem=function(e,r){var o=a(e);o?r.error?(o.status=r.error,o.completed=-1):o.api?(o.completed=.5,c.import.api&&t(function(){c.import.api(o.api,function(e){var t,a,r;e.ok&&c.import.monitor?(o.monitor=e.monitor,o.completed=.51,a=!1,r=0,(t=o).interval_id=0,t.interval_id=l(function(){a||(a=!0,c.import.monitor(t.monitor,function(e){var r;a=!1,e.ok?0<e.completed&&e.completed<1?t.completed=.5+e.completed/2:(l.cancel(t.interval_id),e.type?("video"===(r=e.type)&&e.no_video&&"false"!==e.no_video&&(r="audio"),i.amm_browser_group_change(r)):console.error("import_monitor_response did not include type key",e),-1<(r=m.indexOf(t))?m.splice(r,1):console.error("could not delete upload",t)):(t.completed=-1,t.status=e.error||_(e),l.cancel(t.interval_id)),n()},function(e){a=!1,e.status||r++,5<r&&(t.status=String(r)+" error responses from import monitor cgi",t.completed=-1,l.cancel(t.interval_id),n())}))},5e3)):(o.status=e.error||_(e),o.completed=-1),n()})},20)):console.error("upload had no api key?",o):console.error("could not find upload for item?",e),n()},e.onErrorItem=function(e){var r=a(e);r?(r.status="problem uploading "+r.file,r.completed=-1,n()):console.error("could not find upload for item",e)}),c.module&&c.module.search?i.amm_browser_group="theme":i.amm_browser_group="video",i.amm_import_displayed_status=function(){for(var e=m.length,r=0;r<e;r++)if(-1===m[r].completed){m.splice(r,1);break}n()},i.amm_browser_group_change=function(e){if(e&&(i.amm_browser_group=e,r[i.amm_browser_group]&&delete r[i.amm_browser_group]),!r[i.amm_browser_group])switch(i.amm_browser_group){case"image":case"video":case"audio":c.media&&(r[i.amm_browser_group]=c.media.search({group:i.amm_browser_group}));break;default:c.module&&(r[i.amm_browser_group]=c.module.search({group:i.amm_browser_group}))}i.amm_media=r[i.amm_browser_group]},i.amm_browser_group_change()}]}}]),e.directive("ammDragMedia",["$amm","$parse",function(e,i){return{restrict:"AEC",templateUrl:"views/browser/clip.html",link:function(a,e,o){e.bind("dragstart",function(e){var r=o.ammDragMedia,t=i(r)(a),r={media:t,x:e.layerX,y:e.layerY},t="amm-"+t.type;e.dataTransfer.effectAllowed="link",e.dataTransfer.setData(t,angular.toJson(r))})}}}]),e.directive("ammInspector",["$amm",function(a){return{restrict:"AEC",replace:!1,link:function(e){e.amm_inspector_include=function(e){var r,t;if(e)if(e===a.player.mash)r="views/inspector/mash.html";else if(t=a.player.media(e))if(t.inspector)r=t.inspector;else switch(t.type){case"theme":case"transition":if(t.html){r=t.html;break}case"video":case"audio":case"image":r="views/inspector/"+t.type+".html";break;default:r=t.html}return r}}}}]),e.directive("ammInspectorEffects",["$amm",function(m){return{restrict:"AEC",controller:["$scope","$element","$amm",function(c,s){var p=this;p.__effects_drag_data=function(e,r){var t,a,o,i,n,m,l;if(e&&(a=function(e){for(var r,t=["amm-effects","amm-effect"],a=t.length,o=0;o<a;o++)if(-1<d(e,r=t[o]))return r;return!1}(e.dataTransfer.types))){for(n=!0,o={type:a,multiple:"amm-effects"===a,over_index:-1},r&&(o.data=e.dataTransfer.getData(a),o.data&&(o.data=angular.fromJson(o.data))),t={},l=angular.element(e.target);(l=l&&u(l))&&"ammInspectorEffects"!==(m=l.data("amm-directive"));)l=(t[m]=l).parent();t.ammInspectorEffect&&(i=t.ammInspectorEffect,o.effect=i.data("amm-object"))}return p.__over_effect_element===i&&p.__drop_ok===n||c.$apply(function(){var e;p.__over_effect_element!==i&&(p.__over_effect_element&&p.__over_effect_element.toggleClass("amm-drop-dragover",!1),p.__over_effect_element=i,p.__over_effect_element&&(o.over_index=(e=i,Array.prototype.indexOf.call(e[0].parentNode.childNodes,e[0])),p.__over_effect_element.toggleClass("amm-drop-dragover",!0))),p.__drop_ok!==n&&(p.__drop_ok=n,s.toggleClass("amm-drop-dragover",p.__drop_ok))}),n&&(e.preventDefault(),e.dataTransfer.dropEffect=o.multiple?"move":"all"),o}}],link:function(o,i,e,n){i.data("amm-directive","ammInspectorEffects"),i.bind("dragenter",n.__effects_drag_data),i.bind("dragover",n.__effects_drag_data),i.bind("dragleave",function(){n.__effects_drag_data()}),i.bind("drop",function(e){var r,t,a=n.__effects_drag_data(e,!0);a&&(r=m.player.selectedClipOrMash.effects,-1===(t=a.over_index)&&(t=r.length),o.$apply(function(){i.toggleClass("amm-drop-dragover",!1),a.multiple?m.player.move(m.player.selectedEffects,"effect",t):m.player.add(a.data.media,"effect",t)}),e.stopPropagation&&e.stopPropagation(),e.preventDefault())}),i.bind("dragend",function(e){"none"===e.dataTransfer.dropEffect&&o.$apply(function(){m.player.remove(m.player.selectedEffects,"effect")})})}}}]),e.directive("ammInspectorEffect",["$amm","$parse",function(o,i){return{restrict:"A",link:function(e,r,t){r.data("amm-directive","ammInspectorEffect"),r.data("amm-object",e.effect);var a=i(t.ammInspectorEffect)(e);r.attr("draggable",!0),r.bind("dragstart",function(e){var r;o.player.selected(a)?(r={effects:o.player.selectedEffects,x:e.layerX,y:e.layerY},e.dataTransfer.effectAllowed="copyMove",e.dataTransfer.setData("amm-effects",angular.toJson(r))):(e.stopPropagation&&e.stopPropagation(),e.preventDefault())})}}}]),e.directive("ammTimeline",["$amm",function(){return{restrict:"AEC",controller:["$scope","$element","$amm",function(c,s,n){var p=this,t=[];p.scrollLeft=0,p.scrollTop=0;function r(){for(var e=t.length,r=0;r<e;r++)t[r]()}p.pixels_from_frame=function(e,r,t,a){t=t||n.player.mash.quantize;var o,i=0;return e&&(o=p.pixels_per_second(a))&&(i=e/t*o,!r&&void 0!==r||(i=Math[r||"ceil"](i))),i},p.frame_from_pixels=function(e,r,t){t=t||n.player.mash.quantize;var a,o=0;return e&&(a=p.pixels_per_second())&&(o=e/a*t,!r&&void 0!==r||(o=Math[r||"round"](o))),o},p.pixels_per_second=function(e){var r=0,t=e?0:20,e=n.player?n.player.duration:0;return e&&(r=(c.amm_timeline_width()-t)/(e*(1.01-Math.max(.01,Math.min(1,c.amm_zoom))))),r},p.register_scroller=function(e){t.push(e)},p.timeline_drag_data=function(e,r){var t,a,o,i,n,m,l;if(e&&(a=function(e){for(var r,t=["amm-clips-audio","amm-clips-overlays","amm-clips-video","amm-transition","amm-image","amm-frame","amm-theme","amm-video","amm-audio"],a=t.length,o=0;o<a;o++)if(-1<d(e,r=t[o]))return r;return!1}(e.dataTransfer.types))){for(o={type:a,multiple:"amm-clips-"===a.substr(0,10)},r&&(o.data=e.dataTransfer.getData(a),o.data&&(o.data=angular.fromJson(o.data))),t={},l=angular.element(e.target);(l=l&&u(l))&&"ammTimelineTracks"!==(m=l.data("amm-directive"));)l=(t[m]=l).parent();t.ammTimelineTrack&&(o.track=t.ammTimelineTrack.data("amm-object"),t.ammTimelineClip&&(o.clip=t.ammTimelineClip.data("amm-object")),o.multiple?n=(n="amm-clips-"+o.track.type===o.type)||"video"===o.track.type&&"amm-clips-overlays"===o.type:(n="amm-"+o.track.type===o.type)||"video"!==o.track.type||(n="amm-transition"===o.type?!o.track.index:"amm-audio"!==o.type),n&&(i=t.ammTimelineTrack))}return p.__over_track_element===i&&p.__drop_ok===n||c.$apply(function(){p.__over_track_element!==i&&(p.__over_track_element&&p.__over_track_element.toggleClass("amm-drop-dragover",!1),p.__over_track_element=i,p.__over_track_element&&p.__over_track_element.toggleClass("amm-drop-dragover",!0)),p.__drop_ok!==n&&(p.__drop_ok=n,s.parent().toggleClass("amm-drop-dragover",p.__drop_ok))}),e&&e.preventDefault(),n&&(e.dataTransfer.dropEffect=o.multiple?"move":"all"),o},p.track_for_clips=function(e){for(var r,t=e.length,a=0;a<t;a++){switch(n.player.media(e[a]).type){case"audio":r="audio";break;case"transition":r="video"}if(r)break}return r=r||"overlays"},c.amm_timeline_scroll=function(e){p.scrollLeft=e.target.scrollLeft,p.scrollTop=e.target.scrollTop,r()},c.amm_selected_class=function(e){return{"amm-selected":n.player.selected(e)}},c.amm_style_clip=function(e,r){var t={},a=n.player.media(e);return t.width=p.pixels_from_frame(e.frames,"floor")+"px",t["z-index"]=100*("transition"===a.type?10:1)+r.clips.indexOf(e),t.left=p.pixels_from_frame(e.frame,"floor")+"px",t.position="absolute",t},c.amm_timeline_view_width=function(){var e=n.player?n.player.duration:0,e=e?e*p.pixels_per_second(!0):c.amm_timeline_width();return e},c.amm_zoom=0,c.$watch("amm_zoom",function(){var e=p.pixels_from_frame(n.player.frame,"round",n.player.fps,!0);e-=c.amm_timeline_width()/2,p.scrollLeft=Math.max(0,e),r()})}]}}]),e.directive("ammTimelineTrackControls",["$amm",function(){return{restrict:"AEC",require:"^ammTimeline",link:function(e,r,t,a){a.register_scroller(function(){r[0].scrollTop=a.scrollTop}),e.amm_track_controls_width=function(){return r[0].getBoundingClientRect().width}}}}]),e.directive("ammTimelineRuler",["$amm","$document",function(l,c){return{restrict:"E",require:"^ammTimeline",link:function(t,r,e,a){function o(r){t.$apply(function(){var e=r.pageX-m,e=a.frame_from_pixels(e,"round",l.player.fps);l.player.frame=Math.max(0,Math.min(l.player.frames,e))})}function i(e){o(e),n.unbind("mousemove"),n.unbind("mouseup"),n.unbind("mouseleave")}var n=angular.element(c[0].body),m=0;r.bind("mousedown",function(e){m=r[0].getBoundingClientRect().left+t.amm_track_controls_width()-a.scrollLeft,o(e),n.bind("mousemove",o),n.bind("mouseup",i),n.bind("mouseleave",i)})}}}]),e.directive("ammTimelineRule",["$amm",function(o){return{restrict:"E",require:"^ammTimeline",link:function(r,t,e,a){a.register_scroller(function(){r.$$phase||r.$apply(function(){})}),r.amm_style_rule=function(){var e={};return e.left=a.pixels_from_frame(o.player.frame,"round",o.player.fps),e.left-=Math.round(t[0].getBoundingClientRect().width/2),e.left+=r.amm_track_controls_width()-a.scrollLeft,e.left=String(e.left)+"px",e}}}}]),e.directive("ammTimelineTracks",["$timeout","$amm","$window","$rootScope",function(r,m,e,t){return e.onresize=function(){t.$apply(function(){})},{restrict:"AEC",require:"^ammTimeline",link:function(o,i,e,n){n.register_scroller(function(){i[0].scrollLeft!==n.scrollLeft&&r(function(){i[0].scrollLeft=n.scrollLeft})}),o.amm_timeline_width=function(){return i[0].getBoundingClientRect().width},i.data("amm-directive","ammTimelineTracks"),e.$set("class","amm-timeline-tracks"),i.bind("scroll",o.amm_timeline_scroll),i.bind("dragenter",n.timeline_drag_data),i.bind("dragover",n.timeline_drag_data),i.bind("dragleave",function(){}),i.bind("drop",function(e){var r,t,a=n.timeline_drag_data(e,!0);a&&(e.dataTransfer.dropEffect,n.timeline_drag_data(),m.player.mash[a.track.type],t=a.track.index,r="video"!==a.track.type||t?Math.max(0,n.frame_from_pixels(e.pageX-i[0].getBoundingClientRect().left-a.data.x)):a.clip?a.track.clips.indexOf(a.clip):a.track.clips.length,o.$apply(function(){a.multiple?m.player.move(m.player.selectedClips,a.track.type,r,t):m.player.add(a.data.media,a.track.type,r,t)}),e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault())})}}}]),e.directive("ammTimelineTrack",["$amm",function(t){return{restrict:"AEC",link:function(e,r){r.data("amm-directive","ammTimelineTrack"),r.data("amm-object",e.track),r.bind("mousedown",function(){e.$apply(function(){t.player.select(!1)})})}}}]),e.directive("ammTimelineClip",["$amm","$parse",function(l){return{restrict:"E",require:"^ammTimeline",templateUrl:"views/timeline/clip.html",replace:!0,link:function(n,e,r,m){e.data("amm-directive","ammTimelineClip"),e.data("amm-object",n.clip),e.bind("mousedown",function(e){n.$apply(function(){l.player.select(n.clip,e.shiftKey),e.stopPropagation&&e.stopPropagation()})}),e.bind("dragstart",function(e){if(l.player.selected(n.clip)){e.dataTransfer.effectAllowed="copyMove";for(var r,t={},a={clips:l.player.selectedClips,x:e.layerX,y:e.layerY,media:[]},o=a.clips.length,i=(1<o&&e.dataTransfer.addElement,0);i<o;i++)r=a.clips[i],t[(r=l.player.media(r)).id]||(t[r.id]=!0,a.media.push(r));e.dataTransfer.setData("amm-clips-"+m.track_for_clips(a.clips),angular.toJson(a))}else e.stopPropagation&&e.stopPropagation(),e.preventDefault()}),e.bind("dragend",function(e){"none"===e.dataTransfer.dropEffect&&n.$apply(function(){l.player.remove(l.player.selectedClips,n.track.type,n.track.index)})}),e.on("$destroy",function(){e.data("amm-object",null),e.data("amm-directive",null)})}}}]),e.directive("ammSynced",["$amm","$interval",function(e,r){return{restrict:"AEC",link:function(){r(function(){},100)}}}]),e.filter("secondsFromFrames",function(){return function(e,r){return e/r}}),e.filter("displaySeconds",function(){function m(e,r,t){return t=t||"0",(e+="").length>=r?e:new Array(r-e.length+1).join(t)+e}return function(e,r,t){var a,o,i="",n=2;return(a=3600)<=(t=t||e)&&(a<=e?(i+=m(String(Math.floor(e/a)),n),o=!0,e%=a):i+="00:"),a=60,(o||a<=t)&&(o&&(i+=":"),a<=e?(i+=m(String(Math.floor(e/a)),n),o=!0,e%=a):i+="00:"),a=1,o||a<=t?(o&&(i+=":"),a<=e?(i+=m(String(Math.floor(e/a)),n),o=!0,e%=a):i+="00"):i+="00",1<r&&(10===r&&(n=1),i+=".",e?(e=1===n?Math.floor(10*e)/10:Math.floor(100*e)/100,e=Number(String(e).substr(2,2)),i+=m(String(e),n)):i+=m("0",n)),i}})}();