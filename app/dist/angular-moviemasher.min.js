!function(){"use strict";var a={rest:{media:{search:{url:"php/media.php?group=:group",params:{group:"@group"},method:"get",isArray:!0}},module:{search:{url:"php/media.php?group=:group",params:{group:"@group"},method:"get",isArray:!0}},mash:{search:{url:"php/media.php?group=mash",method:"get",isArray:!0},data:{url:"php/mash.php?id=:id",params:{id:"@id"},method:"get"},save:{url:"php/save.php?id=:id",params:{id:"@id"},method:"post"}},import:{api:{url:"php/import_api.php",method:"post"},init:{url:"php/import_init.php",method:"post"},monitor:{url:"php/import_monitor.php",method:"post"}},export:{init:{url:"php/export_init.php",method:"post"},monitor:{url:"php/export_monitor.php",method:"post"}}}},b=function(a,b){return a-b[0].getBoundingClientRect().left},c=function(a,b){var c,d;if(a){if(a.indexOf)return a.indexOf(b);for(d=a.length,c=0;c<d;c++)if(a[c]===b)return c}return-1},d=function(a){for(var b;a&&!(b=a.data("amm-directive"));)a=a.parent();return a},e=function(a){console.error("response error",a);var b,c=0,d=[];for(b=a[c];b;)d.push(b),c++,b=a[c];return d.join("")},f=angular.module("angular.moviemasher",["ngResource","ngAnimate","colorpicker.module","angularFileUpload","ui.bootstrap"]);f.config(["$httpProvider",function(a){a.defaults.useXDomain=!0,a.defaults.withCredentials=!0}]),f.constant("amm_resources",{});var g=function(b,c,d){b||(b=a);var e,f,g,h,i,j;for(h in a.rest)if(i=a.rest[h],j=b.rest[h],i!==j&&!0!==j||(j=i),j){g={};for(f in j)e={},i[f].isArray&&(e.isArray=!0),e.method=i[f].method,e.url=j[f].url,j[f].params&&(e.params=j[f].params),g[f]=e;c[h]=d(null,null,g)}};f.config(["$provide",function(a){var b=["$http"],c=MovieMasher,d=c.prototype;c.$inject=b,d.initialize=function(){this.registered=c.registered,this.supported=c.supported;var a,d=b.length;for(this.amm_injected={},a=0;a<d;a++)this.amm_injected[b[a]]=this.instance_arguments[a]},d.__player=null,Object.defineProperty(d,"player",{get:function(){return this.__player||(this.__player=c.player()),this.__player},set:function(a){this.__player=a}}),a.service("$amm",c)}]),f.directive("ammUi",["$amm","amm_resources","$resource",function(a,b,c){return{templateUrl:"views/ui.html",restrict:"AEC",controller:["$scope","$window","$interval","amm_resources",function(b,c,d,f){b.amm_resources=f;var g=-1;a.player.did=function(b){b&&g>=a.player.action_index&&(g=-2)},b.amm_export_displayed_status=function(){b.amm_export_completed=0},b.amm_export_completed=0,b.amm_import_completed=0,b.amm_export_status="",b.amm_import_status="";var h=5,i=function(a,c){var g=!1,i=0,k=0;i=d(function(){g||(g=!0,f.export.monitor(a,function(a){if(g=!1,a.ok){if(a.completed>0&&a.completed<1)b.amm_export_completed=Math.max(.03,a.completed);else if(d.cancel(i),1===a.completed){var f=j(c);f&&(f.source=a.source),b.amm_export_completed=0}}else b.amm_export_status=a.error||e(a),b.amm_export_completed=-1,d.cancel(i)},function(a){console.warn("export.monitor",a),g=!1,a.status||k++,k>h&&(b.amm_export_status=String(k)+" error responses from export monitor cgi",b.amm_export_completed=-1,d.cancel(i))}))},5e3)};a.render=function(){var c=a.mash_id;f.export&&(b.amm_export_completed=.01,f.export.init({id:c},function(a){a.ok?(b.amm_export_completed=.02,i(a,c)):(b.amm_export_status=a.error||e(a),b.amm_export_completed=-1)},function(a){console.error("export.init",a),b.amm_export_status="error response from export init",b.amm_export_completed=-1}))},a.can=function(b){var c=!1;switch(b){case"render":c=f.export&&a.player.duration&&!a.can("save");break;case"save":c=f.mash&&f.mash.save&&g!==a.player.action_index}return c},a.save=function(b){if(f.mash&&f.mash.save){var d=a.mash_id,h=a.player.action_index;f.mash.save({id:d},a.player.mash,function(f){if(f.ok){if(d===a.mash_id){g=h,k[d]&&delete k[d];var i=j(d);i&&(i.label=a.player.mash.label),b&&(a.mash_id=b,a.mash_id_change())}}else c.alert(f.error||e(f))})}};var j=function(b){var c,d=a.mashes.length;for(c=0;c<d;c++)if(a.mashes[c].id===b)return a.mashes[c];return!1},k={};b.amm_view_mash=function(){c.open(a.selected_mash.source)},a.mash_id_change=function(){var b=a.mash_id,d=a.player.mash.id;if(a.can("save"))a.mash_id=d,c.confirm('Save changes to "'+a.player.mash.label+'"?')&&a.save(b);else{var h={};if(b){var i=j(b);i&&(a.selected_mash=i,h.label=i.label,h.id=b,k[b]||f.mash&&f.mash.data({id:b},function(d){d.ok?b===a.mash_id&&(g=-1,a.player.mash=d.data):c.alert(d.error||e(d))}))}else h.label="New Untitled Mash",h.id=a.player.uuid(),k[h.id]=!0,a.mashes.push(h),a.mash_id=h.id,a.selected_mash=h;a.mash_id===h.id&&(g=-1,a.player.mash=h)}},a.mashes=[],a.mash_id=0,b.$amm=a,b.log_mash=function(){},b.amm_style_media_icon=function(a){var b,c={};if(a.icon)b=a.icon;else switch(a.type){case"image":b=a.url||a.source;break;case"audio":b=a.wave}return"audio"===a.type&&(c["background-size"]="100% 100%"),b&&(c["background-image"]="url("+b+")"),c},b.amm_media_icon_url=function(a){var b;if(a)if(a.icon)b=a.icon;else switch(a.type){case"image":b=a.url||a.source;break;case"audio":b=a.wave}else console.error("amm_media_icon_url received invalid parameter",a);return b}}],link:function(d,e,f){var h,i,j,k,l,m,n,o,p;a.MovieMasher.configure({mash:{default:{quantize:10}}});for(m in f.$attr)switch(m){case"class":case"ammUi":break;default:if(o=f.$attr[m],n=f[m],l=o.split("-"),"amm"===l.shift())for(j=l.length,p||(p={}),h=p,i=0;i<j;i++)k=l[i],h[k]||(i===j-1?h[k]=n:h[k]={}),h=h[k]}g(p,b,c),b.module&&b.module.search&&(b.module.search({group:"font"},function(c){a.MovieMasher.register("font",c),b.mash&&b.mash.search({},function(b){b.length&&(angular.forEach(b,function(b){a.mashes.push(b)}),a.mash_id=a.mashes[0].id),a.mash_id_change()})}),b.module.search({group:"filter"},function(b){a.MovieMasher.register("filter",b)}),b.module.search({group:"scaler"},function(b){a.MovieMasher.register("scaler",b)}),b.module.search({group:"merger"},function(b){a.MovieMasher.register("merger",b)}))}}}]),f.directive("ammPlayer",["$window","$amm",function(a,b){return{restrict:"AEC",replace:!1,template:'<canvas id="amm-canvas"></canvas>',link:function(c,d){if(a.CanvasRenderingContext2D){var e=d.find("canvas"),f=d[0].getBoundingClientRect();e.attr("width",f.width),e.attr("height",f.height),b.player.canvas_context=e[0].getContext("2d"),d.on("$destroy",function(){b.player.destroy()})}}}}]),f.directive("ammBrowser",["$timeout","$interval","$amm","amm_resources",function(a,b,c,d){return{restrict:"AEC",replace:!1,controller:["$scope","FileUploader",function(c,f){var g=5;c.amm_import_displayed_status=function(){var a,b,c;for(c=j.length,b=0;b<c;b++)if(a=j[b],-1===a.completed){j.splice(b,1);break}k()};var h=c.uploader=new f({scope:c}),i={},j=[],k=function(){var a,b,d,e=0,f=0;for(d=j.length,b=0;b<d;b++){if(a=j[b],-1===a.completed)return c.amm_import_completed=-1,void(c.amm_import_status=a.status);f++,e+=a.completed}c.amm_import_completed=f?e/f:0,c.amm_import_status=""},l=function(a){var b,c,d=j.length;for(c=0;c<d;c++)if(b=j[c],b.upload===a)return b;return!1},m=function(a){var f=!1,h=0;a.interval_id=0,a.interval_id=b(function(){f||(f=!0,d.import.monitor(a.monitor,function(d){if(f=!1,d.ok)if(d.completed>0&&d.completed<1)a.completed=.5+d.completed/2;else{if(b.cancel(a.interval_id),d.type){var g=d.type;"video"===g&&d.no_video&&"false"!==d.no_video&&(g="audio"),c.amm_browser_group_change(g)}else console.error("import_monitor_response did not include type key",d);var h=j.indexOf(a);-1<h?j.splice(h,1):console.error("could not delete upload",a)}else a.completed=-1,a.status=d.error||e(d),b.cancel(a.interval_id);k()},function(c){console.error("import.monitor",c),f=!1,c.status||h++,h>g&&(a.status=String(h)+" error responses from import monitor cgi",a.completed=-1,b.cancel(a.interval_id),k())}))},5e3)};d.import&&(h.onProgressItem=function(a,b){var c=l(a);c?(c.completed=Math.max(.03,b/200),k()):console.error("could not find upload for item",a)},h.onAfterAddingFile=function(a){var b={};b.file=a.file.name,b.size=a.file.size,b.type=a.file.type;var c={};c.uploading=!0,c.upload=a,c.completed=.01,c.name=b.name,j.unshift(c),k();var f=function(a,b){a.completed=-1,a.status=b,k()};d.import.init(b,function(b){if(b.ok){if(c.completed=.02,a.formData.push(b.data),b.headers)for(var d in b.headers)a.headers[d]=b.headers[d];c.api=b.api,a.url=b.endpoint,a.method=b.method,a.upload()}else f(c,b.error||e(b))},function(){console.error("import.init problem uploading",arguments),f(c,"error")})},h.onSuccessItem=function(b,c){console.info("onSuccessItem",arguments);var f;f=l(b),f?c.error?(f.status=c.error,f.completed=-1):f.api?(f.completed=.5,d.import.api&&a(function(){d.import.api(f.api,function(a){a.ok&&d.import.monitor?(f.monitor=a.monitor,f.completed=.51,m(f)):(f.status=a.error||e(a),f.completed=-1),k()})},20)):console.error("upload had no api key?",f):console.error("could not find upload for item?",b),k()},h.onErrorItem=function(a){console.error("onErrorItem",arguments);var b=l(a);b?(b.status="problem uploading "+b.file,b.completed=-1,k()):console.error("could not find upload for item",a)}),d.module&&d.module.search?c.amm_browser_group="theme":c.amm_browser_group="video",c.amm_browser_group_change=function(a){if(a&&(c.amm_browser_group=a,i[c.amm_browser_group]&&delete i[c.amm_browser_group]),!i[c.amm_browser_group])switch(c.amm_browser_group){case"image":case"video":case"audio":d.media&&(i[c.amm_browser_group]=d.media.search({group:c.amm_browser_group}));break;default:d.module&&(i[c.amm_browser_group]=d.module.search({group:c.amm_browser_group}))}c.amm_media=i[c.amm_browser_group]},c.amm_browser_group_change()}]}}]),f.directive("ammDragMedia",["$amm","$parse",function(a,b){return{restrict:"AEC",templateUrl:"views/browser/clip.html",link:function(a,c,d){c.bind("dragstart",function(c){var e=d.ammDragMedia,f=b(e)(a),g={media:f,x:c.layerX,y:c.layerY},h="amm-"+f.type;c.dataTransfer.effectAllowed="link",c.dataTransfer.setData(h,angular.toJson(g))})}}}]),f.directive("ammInspector",["$amm",function(a){return{restrict:"AEC",replace:!1,link:function(b){b.amm_inspector_include=function(b){var c,d;if(b)if(b===a.player.mash)c="views/inspector/mash.html";else if(d=a.player.media(b))if(d.inspector)c=d.inspector;else switch(d.type){case"theme":case"transition":if(d.html){c=d.html;break}case"video":case"audio":case"image":c="views/inspector/"+d.type+".html";break;default:c=d.html}return c}}}}]),f.directive("ammInspectorEffects",["$amm",function(a){return{restrict:"AEC",controller:["$scope","$element","$amm",function(a,b){var e=this,f=function(a){var b,d,e,f=["amm-effects","amm-effect"];for(e=f.length,d=0;d<e;d++)if(b=f[d],-1<c(a,b))return b;return!1},g=function(a){return Array.prototype.indexOf.call(a[0].parentNode.childNodes,a[0])};e.__effects_drag_data=function(c,h){var i,j,k,l,m,n,o;if(c&&(j=f(c.dataTransfer.types))){for(m=!0,k={type:j,multiple:"amm-effects"===j,over_index:-1},h&&(k.data=c.dataTransfer.getData(j),k.data&&(k.data=angular.fromJson(k.data))),i={},o=angular.element(c.target);o&&(o=d(o))&&(n=o.data("amm-directive"),"ammInspectorEffects"!==n);)i[n]=o,o=o.parent();i.ammInspectorEffect&&(l=i.ammInspectorEffect,k.effect=l.data("amm-object"))}return e.__over_effect_element===l&&e.__drop_ok===m||a.$apply(function(){e.__over_effect_element!==l&&(e.__over_effect_element&&e.__over_effect_element.toggleClass("amm-drop-dragover",!1),e.__over_effect_element=l,e.__over_effect_element&&(k.over_index=g(l),e.__over_effect_element.toggleClass("amm-drop-dragover",!0))),e.__drop_ok!==m&&(e.__drop_ok=m,b.toggleClass("amm-drop-dragover",e.__drop_ok))}),m&&(c.preventDefault(),c.dataTransfer.dropEffect=k.multiple?"move":"link"),k}}],link:function(b,c,d,e){c.data("amm-directive","ammInspectorEffects"),c.bind("dragenter",e.__effects_drag_data),c.bind("dragover",e.__effects_drag_data),c.bind("dragleave",function(){e.__effects_drag_data()}),c.bind("drop",function(d){var f,g,h=e.__effects_drag_data(d,!0);h&&(f=a.player.selectedClipOrMash.effects,g=h.over_index,-1===g&&(g=f.length),b.$apply(function(){c.toggleClass("amm-drop-dragover",!1),h.multiple?a.player.move(a.player.selectedEffects,"effect",g):a.player.add(h.data.media,"effect",g)}),d.stopPropagation&&d.stopPropagation(),d.preventDefault())}),c.bind("dragend",function(c){"none"===c.dataTransfer.dropEffect&&b.$apply(function(){a.player.remove(a.player.selectedEffects,"effect")})})}}}]),f.directive("ammInspectorEffect",["$amm","$parse",function(a,b){return{restrict:"A",link:function(c,d,e){d.data("amm-directive","ammInspectorEffect"),d.data("amm-object",c.effect);var f=b(e.ammInspectorEffect)(c);d.attr("draggable",!0),d.bind("dragstart",function(b){if(a.player.selected(f)){var c={effects:a.player.selectedEffects,x:b.layerX,y:b.layerY};b.dataTransfer.effectAllowed="moveCopy",b.dataTransfer.setData("amm-effects",angular.toJson(c))}else b.stopPropagation&&b.stopPropagation(),b.preventDefault()})}}}]),f.directive("ammTimeline",["$amm",function(){return{restrict:"AEC",controller:["$scope","$element","$amm",function(a,b,e){var f=this,g=[];f.scrollLeft=0,f.scrollTop=0,f.register_scroller=function(a){g.push(a)},a.amm_timeline_scroll=function(a){f.scrollLeft=a.target.scrollLeft,f.scrollTop=a.target.scrollTop,h()};var h=function(){var a,b;for(b=g.length,a=0;a<b;a++)g[a]()},i=function(){var b=f.pixels_from_frame(e.player.frame,"round",e.player.fps,!0);b-=a.amm_timeline_width()/2,f.scrollLeft=Math.max(0,b),h()},j=function(a){var b,d,e,f=["amm-clips-audio","amm-clips-overlays","amm-clips-video","amm-transition","amm-image","amm-frame","amm-theme","amm-video","amm-audio"];for(e=f.length,d=0;d<e;d++)if(b=f[d],-1<c(a,b))return b;return!1};f.pixels_from_frame=function(a,b,c,d){c||(c=e.player.mash.quantize);var g,h=0;return a&&(g=f.pixels_per_second(d),g&&(h=a/c*g,(b||"undefined"==typeof b)&&(h=Math[b||"ceil"](h)))),h},f.frame_from_pixels=function(a,b,c){c||(c=e.player.mash.quantize);var d,g=0;return a&&(d=f.pixels_per_second(),d&&(g=a/d*c,(b||"undefined"==typeof b)&&(g=Math[b||"round"](g)))),g},f.pixels_per_second=function(b){var c,d=0,f=b?0:20;return c=e.player?e.player.duration:0,c&&(d=(a.amm_timeline_width()-f)/(c*(1.01-Math.max(.01,Math.min(1,a.amm_zoom))))),d},f.timeline_drag_data=function(c,e){var g,h,i,k,l,m,n;if(c&&(h=j(c.dataTransfer.types))){for(i={type:h,multiple:"amm-clips-"===h.substr(0,10)},e&&(i.data=c.dataTransfer.getData(h),i.data&&(i.data=angular.fromJson(i.data))),g={},n=angular.element(c.target);n&&(n=d(n))&&(m=n.data("amm-directive"),"ammTimelineTracks"!==m);)g[m]=n,n=n.parent();g.ammTimelineTrack&&(i.track=g.ammTimelineTrack.data("amm-object"),g.ammTimelineClip&&(i.clip=g.ammTimelineClip.data("amm-object")),i.multiple?(l="amm-clips-"+i.track.type===i.type,l=l||"video"===i.track.type&&"amm-clips-overlays"===i.type):(l="amm-"+i.track.type===i.type,l||"video"!==i.track.type||(l="amm-transition"===i.type?!i.track.index:"amm-audio"!==i.type)),l&&(k=g.ammTimelineTrack))}return f.__over_track_element===k&&f.__drop_ok===l||a.$apply(function(){f.__over_track_element!==k&&(f.__over_track_element&&f.__over_track_element.toggleClass("amm-drop-dragover",!1),f.__over_track_element=k,f.__over_track_element&&f.__over_track_element.toggleClass("amm-drop-dragover",!0)),f.__drop_ok!==l&&(f.__drop_ok=l,b.parent().toggleClass("amm-drop-dragover",f.__drop_ok))}),l&&(c.preventDefault(),c.dataTransfer.dropEffect=i.multiple?"move":"link"),i},f.track_for_clips=function(a){var b,c,d=a.length;for(c=0;c<d;c++){switch(e.player.media(a[c]).type){case"audio":b="audio";break;case"transition":b="video"}if(b)break}return b||(b="overlays"),b},a.amm_selected_class=function(a){return{"amm-selected":e.player.selected(a)}},a.amm_style_clip=function(a,b){var c={},d=e.player.media(a);return c.width=f.pixels_from_frame(a.frames,"floor")+"px",c["z-index"]=100*("transition"===d.type?10:1)+b.clips.indexOf(a),c.left=f.pixels_from_frame(a.frame,"floor")+"px",c.position="absolute",c},a.amm_timeline_view_width=function(){var b,c=e.player?e.player.duration:0;return b=c?c*f.pixels_per_second(!0):a.amm_timeline_width()},a.amm_zoom=0,a.$watch("amm_zoom",i)}]}}]),f.directive("ammTimelineTrackControls",["$amm",function(){return{restrict:"AEC",require:"^ammTimeline",link:function(a,b,c,d){d.register_scroller(function(){b[0].scrollTop=d.scrollTop}),a.amm_track_controls_width=function(){return b[0].getBoundingClientRect().width}}}}]),f.directive("ammTimelineRuler",["$amm","$document",function(a,b){return{restrict:"E",require:"^ammTimeline",link:function(c,d,e,f){var g=angular.element(b[0].body),h=0,i=function(b){c.$apply(function(){var c=b.pageX-h,d=f.frame_from_pixels(c,"round",a.player.fps);a.player.frame=Math.max(0,Math.min(a.player.frames,d))})},j=function(a){i(a),g.unbind("mousemove"),g.unbind("mouseup"),g.unbind("mouseleave")};d.bind("mousedown",function(a){h=d[0].getBoundingClientRect().left+c.amm_track_controls_width()-f.scrollLeft,i(a),g.bind("mousemove",i),g.bind("mouseup",j),g.bind("mouseleave",j)})}}}]),f.directive("ammTimelineRule",["$amm",function(a){return{restrict:"E",require:"^ammTimeline",link:function(b,c,d,e){e.register_scroller(function(){b.$$phase||b.$apply(function(){})}),b.amm_style_rule=function(){var d={};return d.left=e.pixels_from_frame(a.player.frame,"round",a.player.fps),d.left-=Math.round(c[0].getBoundingClientRect().width/2),d.left+=b.amm_track_controls_width()-e.scrollLeft,d.left=String(d.left)+"px",d}}}}]),f.directive("ammTimelineTracks",["$timeout","$amm","$window","$rootScope",function(a,c,d,e){return d.onresize=function(){e.$apply(function(){})},{restrict:"AEC",require:"^ammTimeline",link:function(d,e,f,g){g.register_scroller(function(){e[0].scrollLeft!==g.scrollLeft&&a(function(){e[0].scrollLeft=g.scrollLeft})}),d.amm_timeline_width=function(){return e[0].getBoundingClientRect().width},e.data("amm-directive","ammTimelineTracks"),f.$set("class","amm-timeline-tracks"),e.bind("scroll",d.amm_timeline_scroll),e.bind("dragenter",g.timeline_drag_data),e.bind("dragover",g.timeline_drag_data),e.bind("dragleave",function(){g.timeline_drag_data()}),e.bind("drop",function(a){var f,h,i,j,k=g.timeline_drag_data(a,!0);k&&(f=a.dataTransfer.dropEffect,g.timeline_drag_data(),j=c.player.mash[k.track.type],i=k.track.index,h="video"!==k.track.type||i?Math.max(0,g.frame_from_pixels(b(a.pageX,e)-k.data.x)):k.clip?k.track.clips.indexOf(k.clip):k.track.clips.length,d.$apply(function(){k.multiple?c.player.move(c.player.selectedClips,k.track.type,h,i):c.player.add(k.data.media,k.track.type,h,i)}),a.stopPropagation&&a.stopPropagation(),a.preventDefault&&a.preventDefault())})}}}]),f.directive("ammTimelineTrack",["$amm",function(a){return{restrict:"AEC",link:function(b,c){c.data("amm-directive","ammTimelineTrack"),c.data("amm-object",b.track),c.bind("mousedown",function(){b.$apply(function(){a.player.select(!1)})})}}}]),f.directive("ammTimelineClip",["$amm","$parse",function(a){return{restrict:"E",require:"^ammTimeline",templateUrl:"views/timeline/clip.html",replace:!0,link:function(b,c,d,e){c.data("amm-directive","ammTimelineClip"),c.data("amm-object",b.clip),c.bind("mousedown",function(c){b.$apply(function(){a.player.select(b.clip,c.shiftKey),c.stopPropagation&&c.stopPropagation()})}),c.bind("dragstart",function(c){if(a.player.selected(b.clip)){c.dataTransfer.effectAllowed="moveCopy";var d,f,g,h,i,j={},k={clips:a.player.selectedClips,x:c.layerX,y:c.layerY,media:[]};for(h=k.clips.length,d=h>1&&c.dataTransfer.addElement,g=0;g<h;g++)f=k.clips[g],i=a.player.media(f),j[i.id]||(j[i.id]=!0,k.media.push(i));c.dataTransfer.setData("amm-clips-"+e.track_for_clips(k.clips),angular.toJson(k))}else c.stopPropagation&&c.stopPropagation(),c.preventDefault()}),c.bind("dragend",function(c){"none"===c.dataTransfer.dropEffect&&b.$apply(function(){a.player.remove(a.player.selectedClips,b.track.type,b.track.index)})}),c.on("$destroy",function(){c.data("amm-object",null),c.data("amm-directive",null)})}}}]),f.directive("ammSynced",["$amm","$interval",function(a,b){return{restrict:"AEC",link:function(){b(function(){},100)}}}]),f.filter("secondsFromFrames",function(){return function(a,b){return a/b}}),f.filter("displaySeconds",function(){var a=function(a,b,c){return c=c||"0",a+="",a.length>=b?a:new Array(b-a.length+1).join(c)+a};return function(b,c,d){var e,f,g,h="";return d||(d=b),e=3600,f=2,d>=e&&(b>=e?(h+=a(String(Math.floor(b/e)),f),g=!0,b%=e):h+="00:"),e=60,(g||d>=e)&&(g&&(h+=":"),b>=e?(h+=a(String(Math.floor(b/e)),f),g=!0,b%=e):h+="00:"),e=1,g||d>=e?(g&&(h+=":"),b>=e?(h+=a(String(Math.floor(b/e)),f),g=!0,b%=e):h+="00"):h+="00",c>1&&(10===c&&(f=1),h+=".",b?(b=1===f?Math.floor(10*b)/10:Math.floor(100*b)/100,b=Number(String(b).substr(2,2)),h+=a(String(b),f)):h+=a("0",f)),h}})}();